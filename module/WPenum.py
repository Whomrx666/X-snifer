# Obfuscated by Mr.X
# dont recode this kids:V
import base64
exec(base64.b64decode('IyBUaGlzIHByb2dyYW0gd2FzIGNyZWF0ZWQgYnkgTXIuWAoKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCByZQppbXBvcnQgc3lzCmZyb20gY29sb3JhbWEgaW1wb3J0IGluaXQsIEZvcmUsIFN0eWxlCgppbml0KCkKCmRlZiBwcmludF9iYW5uZXIoKToKICAgIGJhbm5lciA9IHInJycKIF8gICBfIF9fXyAgX19fIF8gX18gICAgX19fIF8gX18gIF8gICBfIF8gX18gX19fICAKfCB8IHwgLyBfX3wvIF8gXCAnX198ICAvIF8gXCAnXyBcfCB8IHwgfCAnXyBgIF8gXCAKfCB8X3wgXF9fIFwgIF9fLyB8ICAgIHwgIF9fLyB8IHwgfCB8X3wgfCB8IHwgfCB8IHwKIFxfXyxffF9fXy9cX19ffF98ICAgICBcX19ffF98IHxffFxfXyxffF98IHxffCB8X3wKICAgICcnJwogICAgcHJpbnQoRm9yZS5DWUFOICsgU3R5bGUuQlJJR0hUICsgYmFubmVyICsgU3R5bGUuUkVTRVRfQUxMKQogICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyBTdHlsZS5CUklHSFQgKyAiVG9vbHMgY3JlYXRlZCBieSBNci5YXG4iICsgU3R5bGUuUkVTRVRfQUxMKQpkZWYgYXV0aG9yX2VudW0od3BfdXJsLCBtYXhfaWQ9MjApOgogICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyBTdHlsZS5CUklHSFQgKyAiWytdIEVudW1lcmF0aW5nIHVzZXJzIHVzaW5nID9hdXRob3I9SUQiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgZm91bmRfdXNlcnMgPSBzZXQoKQogICAgZm9yIHVzZXJfaWQgaW4gcmFuZ2UoMSwgbWF4X2lkICsgMSk6CiAgICAgICAgYXV0aG9yX3VybCA9IGYie3dwX3VybH0vP2F1dGhvcj17dXNlcl9pZH0iCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldChhdXRob3JfdXJsLCBhbGxvd19yZWRpcmVjdHM9VHJ1ZSwgdGltZW91dD0xMCkKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgaWYgIi9hdXRob3IvIiBpbiByZXNwb25zZS51cmw6CiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWUgPSByZXNwb25zZS51cmwuc3BsaXQoIi9hdXRob3IvIilbMV0uc3RyaXAoIi8iKQogICAgICAgICAgICAgICAgICAgIGlmIHVzZXJuYW1lIG5vdCBpbiBmb3VuZF91c2VyczoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIGYiWytdIEZvdW5kIHVzZXI6IHt1c2VybmFtZX0gKElEOiB7dXNlcl9pZH0pIiArIFN0eWxlLlJFU0VUX0FMTCkKICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRfdXNlcnMuYWRkKHVzZXJuYW1lKQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgZiJbLV0gRXJyb3IgYWNjZXNzaW5nIElEIHt1c2VyX2lkfToge2V9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIHJldHVybiBmb3VuZF91c2VycwoKZGVmIHJlc3RfYXBpX2VudW0od3BfdXJsKToKICAgIHByaW50KEZvcmUuWUVMTE9XICsgU3R5bGUuQlJJR0hUICsgIlsrXSBFbnVtZXJhdGluZyB1c2VycyB1c2luZyBSRVNUIEFQSSIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBhcGlfdXJsID0gZiJ7d3BfdXJsfS93cC1qc29uL3dwL3YyL3VzZXJzIgogICAgZm91bmRfdXNlcnMgPSBzZXQoKQogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KGFwaV91cmwsIHRpbWVvdXQ9MTApCiAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICB1c2VycyA9IHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICBmb3IgdXNlciBpbiB1c2VyczoKICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gdXNlci5nZXQoJ25hbWUnKQogICAgICAgICAgICAgICAgaWYgdXNlcm5hbWUgYW5kIHVzZXJuYW1lIG5vdCBpbiBmb3VuZF91c2VyczoKICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgZiJbK10gRm91bmQgdXNlcjoge3VzZXJuYW1lfSAoSUQ6IHt1c2VyWydpZCddfSkiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICAgICAgICAgIGZvdW5kX3VzZXJzLmFkZCh1c2VybmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChGb3JlLlJFRCArICJbLV0gQ291bGQgbm90IHJldHJpZXZlIHVzZXJzIHRocm91Z2ggUkVTVCBBUEkuIiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyBmIlstXSBFcnJvciBpbiBSRVNUIEFQSToge2V9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIHJldHVybiBmb3VuZF91c2VycwoKZGVmIHNpdGVtYXBfZW51bSh3cF91cmwpOgogICAgcHJpbnQoRm9yZS5ZRUxMT1cgKyBTdHlsZS5CUklHSFQgKyAiWytdIFRyeWluZyB0byBmaW5kIHVzZXJzIGluIHNpdGVtYXAiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgc2l0ZW1hcF91cmwgPSBmInt3cF91cmx9L3NpdGVtYXBfaW5kZXgueG1sIgogICAgZm91bmRfdXNlcnMgPSBzZXQoKQogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHNpdGVtYXBfdXJsLCB0aW1lb3V0PTEwKQogICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgbWF0Y2hlcyA9IHJlLmZpbmRhbGwocic8bG9jPiguKj8vYXV0aG9yLy4qPyk8L2xvYz4nLCByZXNwb25zZS50ZXh0KQogICAgICAgICAgICBmb3IgYXV0aG9yX3VybCBpbiBtYXRjaGVzOgogICAgICAgICAgICAgICAgdXNlcm5hbWUgPSBhdXRob3JfdXJsLnNwbGl0KCIvYXV0aG9yLyIpWzFdLnN0cmlwKCIvIikKICAgICAgICAgICAgICAgIGlmIHVzZXJuYW1lIG5vdCBpbiBmb3VuZF91c2VyczoKICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgZiJbK10gRm91bmQgdXNlciBpbiBzaXRlbWFwOiB7dXNlcm5hbWV9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgICAgICAgICAgICAgICAgICBmb3VuZF91c2Vycy5hZGQodXNlcm5hbWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dIFNpdGVtYXAgbm90IGZvdW5kIG9uIHRoZSBzaXRlLiIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBleGNlcHQgcmVxdWVzdHMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KEZvcmUuUkVEICsgZiJbLV0gRXJyb3IgYWNjZXNzaW5nIHNpdGVtYXA6IHtlfSIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICByZXR1cm4gZm91bmRfdXNlcnMKCmRlZiBodG1sX2VudW0od3BfdXJsKToKICAgIHByaW50KEZvcmUuWUVMTE9XICsgU3R5bGUuQlJJR0hUICsgIlsrXSBUcnlpbmcgdG8gZmluZCB1c2VycyBpbiBIVE1MIHNvdXJjZSBjb2RlIiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIGZvdW5kX3VzZXJzID0gc2V0KCkKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh3cF91cmwsIHRpbWVvdXQ9MTApCiAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICBtYXRjaGVzID0gcmUuZmluZGFsbChyJ2F1dGhvcjooLio/KSInLCByZXNwb25zZS50ZXh0LCByZS5JR05PUkVDQVNFKQogICAgICAgICAgICBmb3IgbWF0Y2ggaW4gbWF0Y2hlczoKICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gbWF0Y2guc3RyaXAoKQogICAgICAgICAgICAgICAgaWYgdXNlcm5hbWUgYW5kIHVzZXJuYW1lIG5vdCBpbiBmb3VuZF91c2VyczoKICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgZiJbK10gRm91bmQgdXNlciBpbiBIVE1MIHNvdXJjZSBjb2RlOiB7dXNlcm5hbWV9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgICAgICAgICAgICAgICAgICBmb3VuZF91c2Vycy5hZGQodXNlcm5hbWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dIENvdWxkIG5vdCBhY2Nlc3MgdGhlIG1haW4gcGFnZS4iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgZXhjZXB0IHJlcXVlc3RzLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChGb3JlLlJFRCArIGYiWy1dIEVycm9yIGFjY2Vzc2luZyB0aGUgbWFpbiBwYWdlOiB7ZX0iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgcmV0dXJuIGZvdW5kX3VzZXJzCgpkZWYgcnNzX2VudW0od3BfdXJsKToKICAgIHByaW50KEZvcmUuWUVMTE9XICsgU3R5bGUuQlJJR0hUICsgIlsrXSBUcnlpbmcgdG8gZmluZCB1c2VycyBpbiBSU1MgZmVlZCIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICByc3NfdXJsID0gZiJ7d3BfdXJsfS9mZWVkLyIKICAgIGZvdW5kX3VzZXJzID0gc2V0KCkKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldChyc3NfdXJsLCB0aW1lb3V0PTEwKQogICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgbWF0Y2hlcyA9IHJlLmZpbmRhbGwocic8ZGM6Y3JlYXRvcj4oLio/KTwvZGM6Y3JlYXRvcj4nLCByZXNwb25zZS50ZXh0LCByZS5JR05PUkVDQVNFKQogICAgICAgICAgICBmb3IgdXNlciBpbiBtYXRjaGVzOgogICAgICAgICAgICAgICAgaWYgdXNlciBhbmQgdXNlciBub3QgaW4gZm91bmRfdXNlcnM6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIGYiWytdIEZvdW5kIHVzZXIgaW4gUlNTOiB7dXNlcn0iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICAgICAgICAgIGZvdW5kX3VzZXJzLmFkZCh1c2VyKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgIlstXSBDb3VsZCBub3QgYWNjZXNzIFJTUyBmZWVkLiIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICBleGNlcHQgcmVxdWVzdHMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KEZvcmUuUkVEICsgZiJbLV0gRXJyb3IgYWNjZXNzaW5nIFJTUyBmZWVkOiB7ZX0iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgcmV0dXJuIGZvdW5kX3VzZXJzCgpkZWYgbG9naW5fcGFnZV9lbnVtKHdwX3VybCk6CiAgICBwcmludChGb3JlLllFTExPVyArIFN0eWxlLkJSSUdIVCArICJbK10gVHJ5aW5nIHRvIGZpbmQgdXNlcnMgb24gdGhlIGxvZ2luIHBhZ2UgKHdwLWxvZ2luLnBocCkiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgbG9naW5fdXJsID0gZiJ7d3BfdXJsfS93cC1sb2dpbi5waHAiCiAgICBmb3VuZF91c2VycyA9IHNldCgpCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQobG9naW5fdXJsLCB0aW1lb3V0PTEwKQogICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgbWF0Y2hlcyA9IHJlLmZpbmRhbGwocid1c2VybmFtZT0oLio/KSInLCByZXNwb25zZS50ZXh0LCByZS5JR05PUkVDQVNFKQogICAgICAgICAgICBmb3IgbWF0Y2ggaW4gbWF0Y2hlczoKICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gbWF0Y2guc3RyaXAoKQogICAgICAgICAgICAgICAgaWYgdXNlcm5hbWUgYW5kIHVzZXJuYW1lIG5vdCBpbiBmb3VuZF91c2VyczoKICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgZiJbK10gRm91bmQgdXNlciBvbiB3cC1sb2dpbi5waHA6IHt1c2VybmFtZX0iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICAgICAgICAgIGZvdW5kX3VzZXJzLmFkZCh1c2VybmFtZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludChGb3JlLlJFRCArICJbLV0gQ291bGQgbm90IGFjY2VzcyB0aGUgbG9naW4gcGFnZS4iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgZXhjZXB0IHJlcXVlc3RzLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChGb3JlLlJFRCArIGYiWy1dIEVycm9yIGFjY2Vzc2luZyB0aGUgbG9naW4gcGFnZToge2V9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIHJldHVybiBmb3VuZF91c2VycwoKZGVmIHJvYm90c19lbnVtKHdwX3VybCk6CiAgICBwcmludChGb3JlLllFTExPVyArIFN0eWxlLkJSSUdIVCArICJbK10gVHJ5aW5nIHRvIGZpbmQgaW5mb3JtYXRpb24gaW4gcm9ib3RzLnR4dCIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICByb2JvdHNfdXJsID0gZiJ7d3BfdXJsfS9yb2JvdHMudHh0IgogICAgZm91bmRfdXNlcnMgPSBzZXQoKQogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHJvYm90c191cmwsIHRpbWVvdXQ9MTApCiAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICBtYXRjaGVzID0gcmUuZmluZGFsbChyJyg/aSkvYXV0aG9yLyhcdyspJywgcmVzcG9uc2UudGV4dCkKICAgICAgICAgICAgZm9yIG1hdGNoIGluIG1hdGNoZXM6CiAgICAgICAgICAgICAgICB1c2VybmFtZSA9IG1hdGNoLnN0cmlwKCkKICAgICAgICAgICAgICAgIGlmIHVzZXJuYW1lIGFuZCB1c2VybmFtZSBub3QgaW4gZm91bmRfdXNlcnM6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIGYiWytdIEZvdW5kIHVzZXIgaW4gcm9ib3RzLnR4dDoge3VzZXJuYW1lfSIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICAgICAgICAgICAgICAgICAgZm91bmRfdXNlcnMuYWRkKHVzZXJuYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgIlstXSBDb3VsZCBub3QgYWNjZXNzIHJvYm90cy50eHQuIiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyBmIlstXSBFcnJvciBhY2Nlc3Npbmcgcm9ib3RzLnR4dDoge2V9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIHJldHVybiBmb3VuZF91c2VycwoKZGVmIGVudW1lcmF0ZV91c2Vycyh3cF91cmwsIG1heF9pZD0yMCk6CiAgICB1c2VycyA9IHNldCgpCiAgICB1c2Vycy51cGRhdGUoYXV0aG9yX2VudW0od3BfdXJsLCBtYXhfaWQpKQogICAgdXNlcnMudXBkYXRlKHJlc3RfYXBpX2VudW0od3BfdXJsKSkKICAgIHVzZXJzLnVwZGF0ZShzaXRlbWFwX2VudW0od3BfdXJsKSkKICAgIHVzZXJzLnVwZGF0ZShodG1sX2VudW0od3BfdXJsKSkKICAgIHVzZXJzLnVwZGF0ZShyc3NfZW51bSh3cF91cmwpKQogICAgdXNlcnMudXBkYXRlKGxvZ2luX3BhZ2VfZW51bSh3cF91cmwpKQogICAgdXNlcnMudXBkYXRlKHJvYm90c19lbnVtKHdwX3VybCkpCgogICAgaWYgdXNlcnM6CiAgICAgICAgcHJpbnQoRm9yZS5DWUFOICsgU3R5bGUuQlJJR0hUICsgZiJcblsrXSBFbnVtZXJhdGlvbiBjb21wbGV0ZWQuIEZvdW5kIHtsZW4odXNlcnMpfSB1c2VyczoiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgIGZvciB1c2VyIGluIHVzZXJzOgogICAgICAgICAgICBwcmludChGb3JlLllFTExPVyArIGYiIC0ge3VzZXJ9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dIE5vIHVzZXJzIGZvdW5kIHVzaW5nIHRoZSBhcHBsaWVkIHRlY2huaXF1ZXMuIiArIFN0eWxlLlJFU0VUX0FMTCkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBwcmludF9iYW5uZXIoKQogICAgd3BfdXJsID0gaW5wdXQoRm9yZS5HUkVFTiArICJFbnRlciBhIFVSTCAod2l0aCBodHRwczovLyk6ICIgKyBTdHlsZS5SRVNFVF9BTEwpLnN0cmlwKCkKICAgIGlmIG5vdCB3cF91cmw6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dIFRoZSBVUkwgY2Fubm90IGJlIGVtcHR5LiIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBlbnVtZXJhdGVfdXNlcnMod3BfdXJsLCBtYXhfaWQ9MjApCg==').decode('utf-8'))
